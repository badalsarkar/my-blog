{"componentChunkName":"component---src-templates-blog-post-js","path":"/2020/testing-ci-workflow/2020-11-27-testing-and-ci-workflow-blink/","result":{"data":{"site":{"siteMetadata":{"title":"Blog of Badal Sarkar"}},"markdownRemark":{"id":"aad0c412-9d99-5f5c-a22e-33f2f1b86dda","excerpt":"As part of lab\n8 of\nOSD600, I have implemented automated testing using JUnit 5\nand continuous integration using Github Action in\nBlink. This blog post is about…","html":"<p>As part of <a href=\"https://github.com/Seneca-CDOT/topics-in-open-source-2020/wiki/lab-8\">lab\n8</a> of\nOSD600, I have implemented automated testing using JUnit 5\nand continuous integration using Github Action in\n<a href=\"https://github.com/badalsarkar/Blink\">Blink</a>. This blog post is about\nhow I implemented these tools in my project.</p>\n<h3>Automated testing</h3>\n<p>Blink was written in Java using Maven. There are many popular testing frameworks\nfor Java. <a href=\"https://junit.org/junit5/\">JUnit</a> is among the most widely used.\nJUnit has the 5th major version of the framework, Junit 5 . I have never worked\nwith JUnit so I decided to try using it this time. Setting up Junit 5 with Maven\nis super simple. I added the following dependencies in my <code class=\"language-text\">pom.xml</code></p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-xml line-numbers\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependencies</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.junit.jupiter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>junit-jupiter-api<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>5.4.2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>scope</span><span class=\"token punctuation\">></span></span>test<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>scope</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.junit.jupiter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>junit-jupiter-engine<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>5.4.2<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>scope</span><span class=\"token punctuation\">></span></span>test<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>scope</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>To run the JUnit tests with Maven, I added the Maven <a href=\"https://maven.apache.org/surefire/maven-surefire-plugin/\">Surefire\nplugin</a> in my\npom.xml like below-</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-xml line-numbers\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>build</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugins</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>maven-surefire-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.22.1<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>argLine</span><span class=\"token punctuation\">></span></span>${surefireArgLine}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>argLine</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugins</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>build</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Maven surefire plugin runs the unit tests with the command <code class=\"language-text\">mvn test</code>. It also\ngenerates test reports. The tests need to reside in /src/test/ folder and the\nname of the test file should be one of the following-</p>\n<ul>\n<li>Test*.java</li>\n<li>*Test.java</li>\n<li>*Tests.java</li>\n<li>*TestCase.java</li>\n</ul>\n<p>The element <code class=\"language-text\">argLine</code> is for replacement of properties set on the command line.\nIn my case, this is used for\n<a href=\"https://www.jacoco.org/jacoco/trunk/index.html\">Jacoco</a>, a code coverage\nanalysis tool. I am going to set it up next.</p>\n<p>Jacoco is a free code coverage tool for Java. It generates a report showing how\nmany lines of code has been covered by tests. To set up Jacoco with Maven I\nadded the following dependency which I found in\n<a href=\"https://www.petrikainulainen.net/programming/maven/creating-code-coverage-reports-for-unit-and-integration-tests-with-the-jacoco-maven-plugin/\">this</a>\nblog-</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-xml line-numbers\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plugin</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.jacoco<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>jacoco-maven-plugin<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>0.8.4 <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>executions</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\">&lt;!-- Prepares the property pointing to the JaCoCo runtime agent which \n    is passed as VM argument when Maven the Surefire plugin is executed. --></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>pre-unit-test<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>prepare-agent<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token comment\">&lt;!-- Sets the path to the file which contains the execution data. --></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>destFile</span><span class=\"token punctuation\">></span></span>${project.build.directory}/coverage-reports/jacoco-ut.exec<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>destFile</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token comment\">&lt;!-- Sets the name of the property containing the settings for JaCoCo \n              runtime agent. --></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>propertyName</span><span class=\"token punctuation\">></span></span>surefireArgLine<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>propertyName</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token comment\">&lt;!-- Ensures that the code coverage report for unit tests is created \n      after unit tests have been run. --></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>execution</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>id</span><span class=\"token punctuation\">></span></span>post-unit-test<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>id</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>phase</span><span class=\"token punctuation\">></span></span>test<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>phase</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goals</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>goal</span><span class=\"token punctuation\">></span></span>report<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goal</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>goals</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token comment\">&lt;!-- Sets the path to the file which contains the execution data. --></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dataFile</span><span class=\"token punctuation\">></span></span>${project.build.directory}/coverage-reports/jacoco-ut.exec<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dataFile</span><span class=\"token punctuation\">></span></span>\n              <span class=\"token comment\">&lt;!-- Sets the output directory for the code coverage report. --></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>outputDirectory</span><span class=\"token punctuation\">></span></span>${project.reporting.outputDirectory}/jacoco-ut<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>outputDirectory</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>execution</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>executions</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plugin</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>In the above configuration there are two executions. Lets see what those means.</p>\n<p>First execution [line 8-20]\nsets up Jacoco\n<a href=\"https://www.eclemma.org/jacoco/trunk/doc/prepare-agent-mojo.html\">prepare-agent</a>\ngoal. In Maven a goal is a way to define some actions. The <code class=\"language-text\">prepare-agent</code> goal\ncreates a property which point to the Jacoco runtime agent. This agent is\nresponsible for interacting with application under test and create execution\ndata needed to generate the final report. We are defining the output folder for\nexecution data at line 15 and the property name is defined at line 18. Note that\nthis is the property I set in my Surefire configuration at line 7. This is how\nJacoco interact with Surefire which runs our tests.</p>\n<p>Second execution [line 23-35] defines the <code class=\"language-text\">report</code> goal. This goal generates the\nactual test coverage report. We are specifying that this goal will run at the\n<code class=\"language-text\">test</code> phase at line 25. Read more about Maven build lifecycle <a href=\"https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html\">here</a>.\nNext I am specifying the directory to find the test execution data at <code class=\"language-text\">dataFile</code>\nelement and the directory to save the final report at <code class=\"language-text\">outputDirectory</code> element.</p>\n<p>That’s all for setting automated tests. When I run <code class=\"language-text\">mvn test</code>, all my tests will\nrun and I will get a test coverage report in the specified directory. I will\nshow you below how this looks like.</p>\n<h4>Writing test cases</h4>\n<p>I have a function that extracts all URLs starting with HTTP/HTTPS from some\ntexts. The function looks like below-</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">extractUrlFromText</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> text<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Pattern</span> pattern<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> url <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">argsAreInvalid</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> pattern<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> url<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">int</span> startPos <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> endPos <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Matcher</span> matcher <span class=\"token operator\">=</span> pattern<span class=\"token punctuation\">.</span><span class=\"token function\">matcher</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>matcher<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      startPos <span class=\"token operator\">=</span> matcher<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      endPos <span class=\"token operator\">=</span> matcher<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      url<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">.</span><span class=\"token function\">substring</span><span class=\"token punctuation\">(</span>startPos<span class=\"token punctuation\">,</span> endPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> url<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>I have written several test cases for this function. One of them is following-</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TestExtractor</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token annotation punctuation\">@DisplayName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Text contains two URLs, Extractor returns List of two URLs\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">void</span> <span class=\"token function\">extractTwoUrls</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> text <span class=\"token operator\">=</span> <span class=\"token string\">\"http://github.com https://github.com/badalsarkar/Blink\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Pattern</span> pattern <span class=\"token operator\">=</span>\n        <span class=\"token class-name\">Pattern</span><span class=\"token punctuation\">.</span><span class=\"token function\">compile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"(http|https):\\\\/\\\\/[-a-zA-Z0-9+&amp;@#/%?=~_|!:,.;]*[-a-zA-Z0-9+&amp;@#/%=~_|]\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> actualResult <span class=\"token operator\">=</span> <span class=\"token class-name\">Extractor</span><span class=\"token punctuation\">.</span><span class=\"token function\">extractUrlFromText</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> pattern<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> expectedResult <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ArrayList</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    expectedResult<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://github.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    expectedResult<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://github.com/badalsarkar/Blink\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Assertions</span><span class=\"token punctuation\">.</span><span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span>expectedResult<span class=\"token punctuation\">,</span> actualResult<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>I have named my test class as <code class=\"language-text\">Test+[actual class name]</code>. So, this class will be\npicked up by Surefire plugin. Next I have annotated the method with <code class=\"language-text\">@Test</code>.\nThis annotation marks a method as a test. The annotation <code class=\"language-text\">@DisplayName</code> is used\nto provide a readable name to the test. In the test report this test will show\nas the <code class=\"language-text\">DisplayName</code>. If this is not specified, the method name will be used in\nthe report. However, Surefire plugin is not picking up this annotation. I have\nnot debugged it yet why. This is something I will look at later. Next I call the\nmethod under test at line 10. I am defining <code class=\"language-text\">expectedResult</code> to match the\n<code class=\"language-text\">actualResult</code>. Finally I am matching the expected and actual result at line 16.\nThis is how test cases are written in Junit 5. You can see all the test cases\n<a href=\"https://github.com/badalsarkar/Blink/tree/master/src/test/java/com/badalsarkar/blink/test\">here</a>.</p>\n<p>With several test cases written, I ran the command <code class=\"language-text\">mvn test</code>. It ran all my\ntests and got the following in my console-</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f01a3d3d5bc16d4a1dc91d7bb3c3cffb/0d40b/testREsult.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.025316455696203%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAa0lEQVQI12WLWQ6CMAAFuf/hBLGU0I26lW6cYWjQDxM/Jpm8pZP2gr5PzItAzhJjFEorhLjRDz3eO6wzJ96vhPDCOYvWS8ts8083jld0+3aP58oW3+QSyXmjlPT1SEqBWjP7Xv6ov942J80Pg/yR/amlus4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Blink test result\"\n        title=\"Blink test result\"\n        src=\"/static/f01a3d3d5bc16d4a1dc91d7bb3c3cffb/f058b/testREsult.png\"\n        srcset=\"/static/f01a3d3d5bc16d4a1dc91d7bb3c3cffb/c26ae/testREsult.png 158w,\n/static/f01a3d3d5bc16d4a1dc91d7bb3c3cffb/6bdcf/testREsult.png 315w,\n/static/f01a3d3d5bc16d4a1dc91d7bb3c3cffb/f058b/testREsult.png 630w,\n/static/f01a3d3d5bc16d4a1dc91d7bb3c3cffb/40601/testREsult.png 945w,\n/static/f01a3d3d5bc16d4a1dc91d7bb3c3cffb/0d40b/testREsult.png 1175w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>A test coverage report is also generated. The report looks like below-</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ae8502b9e3a933b15ebff6d52636c362/610c0/testCoverage.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.60759493670886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABZElEQVQoz6WSy07DMBBF+/+fwgIktmxgAQIhEEV9pC0pqE/SxHZs17FTp7mMHbWCNZasO2Npju+M3SuyDKvlAgXj+M9q2xbH4xG94SjBYDDAsN+HyBmUUii1BieVUsWcc06xhBDirOEsaFmKqM65CO6tVxZeldBX11j3n5BJAfaRgr2/gZcceZ6DMRYBRVEgy75jfoJy3sXW2g44mwNmWcBcXuBTJJDOwg0nWL/cYKQTCBqFozNj9rFIKRm1aXx0FXbTNHFH4Gbr0VKr4vEOslEw1sEkU2xfbzEux7ElW1UENASqoGkEFeV1XXdAgh8OB3jvO+Bk2sJmOWbpPb7cAkzSvOYpNiKF8RUYtVlTYVWZWBgcBqCnODgNl/0BfqagB2B4zh+wMgvs2A6aZlQ5hcY35LCMgFOh1tTFL4eni85AJcmhNyh4QW8PKtAQBHHUevgG+303uwANgK51ewYGDbAADesHGQ9kdmzrxJYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Test coverage report \"\n        title=\"Test coverage report \"\n        src=\"/static/ae8502b9e3a933b15ebff6d52636c362/f058b/testCoverage.png\"\n        srcset=\"/static/ae8502b9e3a933b15ebff6d52636c362/c26ae/testCoverage.png 158w,\n/static/ae8502b9e3a933b15ebff6d52636c362/6bdcf/testCoverage.png 315w,\n/static/ae8502b9e3a933b15ebff6d52636c362/f058b/testCoverage.png 630w,\n/static/ae8502b9e3a933b15ebff6d52636c362/40601/testCoverage.png 945w,\n/static/ae8502b9e3a933b15ebff6d52636c362/78612/testCoverage.png 1260w,\n/static/ae8502b9e3a933b15ebff6d52636c362/610c0/testCoverage.png 1295w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The report shows all my classes in the left column and different coverage\nmetrics. For example, the class <code class=\"language-text\">PrintColor</code> has not been tested at all and the\nclass <code class=\"language-text\">Checker</code> has 23% test coverage. Jacoco has following test coverage\nmetrics-</p>\n<ul>\n<li>Instructions (C0 coverage): Signifies how many byte code instructions have\nbeen covered.</li>\n<li>Branches (C1 coverage): For <code class=\"language-text\">if</code> and <code class=\"language-text\">switch</code> statement, whether all possible\nbranches have been tested or not.</li>\n<li>Cyclomatic complexity: It shows how many tests needed to fully cover a class.</li>\n<li>Lines: It tells how many lines have been tested.</li>\n<li>Methods: Signifies how many methods have been tested.</li>\n<li>Class: Signifies how many classes have been tested.</li>\n</ul>\n<p>You can read more about these metrics <a href=\"https://www.jacoco.org/jacoco/trunk/doc/counters.html\">here</a>.</p>\n<h4>Testing network request</h4>\n<p>I have the following method that makes network request to the given <code class=\"language-text\">url</code> and\nreturns an object that stores <code class=\"language-text\">url</code> and the status of request.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">UrlStatus</span> <span class=\"token function\">makeRequest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> url<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">UrlStatus</span> status <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token class-name\">HttpURLConnection</span> connection <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpURLConnection</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">new</span> <span class=\"token function\">URL</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">openConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      connection<span class=\"token punctuation\">.</span><span class=\"token function\">setInstanceFollowRedirects</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      connection<span class=\"token punctuation\">.</span><span class=\"token function\">setRequestMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"HEAD\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      connection<span class=\"token punctuation\">.</span><span class=\"token function\">setConnectTimeout</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      status <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UrlStatus</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">getResponseCode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> ex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UrlStatus</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> status<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>For testing this method, I can write tests that will make actual network request\nand validate if this method is working as expected. But there is a problem in\nthis approach. My test becomes dependent of external resource which is not under\nmy control. For example, if there is no internet connection my test will fail.\nIf the server is down, my test will fail. Also, network requests are slow. But\nunit tests should be fast. So, the solution is to use a mock network request.\nA mock network request acts as an actual request but it doesn’t go over the\nnetwork.</p>\n<p>There are many approaches to achieve this. There are many frameworks that can\ncreate mock object for test purpose. As my method is using <code class=\"language-text\">URL</code> and\n<code class=\"language-text\">HttpURLConnection</code> class, I need to create mock object of these classes. Once I\ncreate mock object, I can configure them to return fake network response. I\ntried to use <a href=\"https://site.mockito.org/\">Mockito</a> and\n<a href=\"https://github.com/powermock/powermock\">PowerMock</a> with JUnit 5. But with\nJUnit 5, neither Mockito nor PowerMock can create mock object of <code class=\"language-text\">URL</code> class. It\nwas possible for Junit4 with older version of Mockito and PowerMock. Another way\nto do this testing is to use mock server. That’s the route I took.</p>\n<p>I have used <a href=\"https://apisimulator.io/\">API Simulator</a> to configure a mock server with custom HTTP status\ncode. So, when my code is making network request, it was going to this server\nwhich is running on localhost. The mock server is returning the pre-configured\nstatus code which my method uses to create the object. Lets see how I configured\nthis mock server-</p>\n<p><strong>Adding dependency</strong></p>\n<p>I added the following to my <code class=\"language-text\">pom.xml</code> file.</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-xml line-numbers\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependencies</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.apisimulator<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>apisimulator-http-embedded<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.7<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><strong>Configuring the mock server</strong></p>\n<p><html><head></head><body><div id=\"gist106676565\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-mocknetworktest-java\" class=\"file my-2\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-java  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tbody><tr>\n        <td id=\"file-mocknetworktest-java-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-mocknetworktest-java-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">public</span> <span class=\"pl-k\">class</span> <span class=\"pl-en\">TestChecker</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-mocknetworktest-java-LC2\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-mocknetworktest-java-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">private</span> <span class=\"pl-k\">static</span> <span class=\"pl-smi\">HttpApiSimulation</span> mockServer <span class=\"pl-k\">=</span> <span class=\"pl-c1\">null</span>;</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-mocknetworktest-java-LC4\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-mocknetworktest-java-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">@BeforeAll</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-mocknetworktest-java-LC6\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">setUp</span>() {</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-mocknetworktest-java-LC7\" class=\"blob-code blob-code-inner js-file-line\">    mockServer <span class=\"pl-k\">=</span> httpApiSimulation(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>mockSim<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-mocknetworktest-java-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c\"><span class=\"pl-c\">//</span> defining mock response</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-mocknetworktest-java-LC9\" class=\"blob-code blob-code-inner js-file-line\">    mockServer<span class=\"pl-k\">.</span>add(</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-mocknetworktest-java-LC10\" class=\"blob-code blob-code-inner js-file-line\">        simlet(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>test-google-good<span class=\"pl-pds\">&quot;</span></span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-mocknetworktest-java-LC11\" class=\"blob-code blob-code-inner js-file-line\">            .when(</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-mocknetworktest-java-LC12\" class=\"blob-code blob-code-inner js-file-line\">                httpRequest()</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-mocknetworktest-java-LC13\" class=\"blob-code blob-code-inner js-file-line\">                    .whereMethod(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>HEAD<span class=\"pl-pds\">&quot;</span></span>)</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-mocknetworktest-java-LC14\" class=\"blob-code blob-code-inner js-file-line\">                    .whereUriPath(isEqualTo(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>/return/200<span class=\"pl-pds\">&quot;</span></span>))</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-mocknetworktest-java-LC15\" class=\"blob-code blob-code-inner js-file-line\">                    .whereHeader(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Host<span class=\"pl-pds\">&quot;</span></span>, contains(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>google.com<span class=\"pl-pds\">&quot;</span></span>)))</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-mocknetworktest-java-LC16\" class=\"blob-code blob-code-inner js-file-line\">            .then(httpResponse()<span class=\"pl-k\">.</span>withStatus(<span class=\"pl-c1\">200</span>)<span class=\"pl-k\">.</span>withHeader(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Content-Type<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>application/text<span class=\"pl-pds\">&quot;</span></span>)));</td>\n      </tr>\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      <tr>\n        <td id=\"file-mocknetworktest-java-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-mocknetworktest-java-LC35\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-mocknetworktest-java-LC36\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-mocknetworktest-java-LC37\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">@AfterAll</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-mocknetworktest-java-LC38\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">tearDown</span>() {</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-mocknetworktest-java-LC39\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">if</span> (mockServer <span class=\"pl-k\">!=</span> <span class=\"pl-c1\">null</span>) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-mocknetworktest-java-LC40\" class=\"blob-code blob-code-inner js-file-line\">      mockServer<span class=\"pl-k\">.</span>stop();</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-mocknetworktest-java-LC41\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-mocknetworktest-java-LC42\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/badalsarkar/596211e7691ebf6f6792231ef65fa606/raw/cb8abc1f5ee5d0b740a73ac92ea3748f11601308/MockNetworkTest.java\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/badalsarkar/596211e7691ebf6f6792231ef65fa606#file-mocknetworktest-java\">MockNetworkTest.java</a>\n        hosted with &#x2764; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html></p>\n<p>The configuration above is really simple. First I instantiate a mock server at\nline 7. From line 9 - 16, I am adding a mock request and response to the server.\nSo, when the server receives a request in the form\n<code class=\"language-text\">https://www.google.com/return/200</code> it will return a status code of <code class=\"language-text\">200</code>. Note,\nthat I have annotated my method with <code class=\"language-text\">@BeforeAll</code> annotation. This means that\nthis method will be executed before running any of the test cases within this\nclass. At the same time I have used <code class=\"language-text\">@AfterAll</code> annotation to stop the server.\n<code class=\"language-text\">@AfterAll</code> annotated method will be executed after all tests within the class\nare run.</p>\n<p>Next, I have used this mock server in the following lines of code.</p>\n<p><html><head></head><body><div id=\"gist106676565\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-mocknetworktest-java\" class=\"file my-2\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-java  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tbody>\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      <tr>\n        <td id=\"file-mocknetworktest-java-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-mocknetworktest-java-LC44\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">@Test</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-mocknetworktest-java-LC45\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">public</span> <span class=\"pl-k\">void</span> <span class=\"pl-en\">testGoodUrl</span>() <span class=\"pl-k\">throws</span> <span class=\"pl-smi\">Exception</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-mocknetworktest-java-LC46\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">try</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-mocknetworktest-java-LC47\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-smi\">System</span><span class=\"pl-k\">.</span>setProperty(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http.proxyHost<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>localhost<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-mocknetworktest-java-LC48\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-smi\">System</span><span class=\"pl-k\">.</span>setProperty(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http.proxyPort<span class=\"pl-pds\">&quot;</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>6090<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-mocknetworktest-java-LC49\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-mocknetworktest-java-LC50\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-smi\">UrlStatus</span> url <span class=\"pl-k\">=</span> <span class=\"pl-smi\">Checker</span><span class=\"pl-k\">.</span>makeRequest(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http://www.google.com/return/200<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-mocknetworktest-java-LC51\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-smi\">Assertions</span><span class=\"pl-k\">.</span>assertEquals(<span class=\"pl-c1\">200</span>, url<span class=\"pl-k\">.</span>getStatusCode());</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-mocknetworktest-java-LC52\" class=\"blob-code blob-code-inner js-file-line\">    } <span class=\"pl-k\">finally</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-mocknetworktest-java-LC53\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-smi\">System</span><span class=\"pl-k\">.</span>clearProperty(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http.proxyHost<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-mocknetworktest-java-LC54\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-smi\">System</span><span class=\"pl-k\">.</span>clearProperty(<span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>http.proxyPort<span class=\"pl-pds\">&quot;</span></span>);</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-mocknetworktest-java-LC55\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-mocknetworktest-java-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"></td>\n        <td id=\"file-mocknetworktest-java-LC56\" class=\"blob-code blob-code-inner js-file-line\">  }</td>\n      </tr>\n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n      \n</tbody></table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/badalsarkar/596211e7691ebf6f6792231ef65fa606/raw/cb8abc1f5ee5d0b740a73ac92ea3748f11601308/MockNetworkTest.java\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/badalsarkar/596211e7691ebf6f6792231ef65fa606#file-mocknetworktest-java\">MockNetworkTest.java</a>\n        hosted with &#x2764; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div>\n</body></html></p>\n<p>First, I have used <code class=\"language-text\">system.setProperty()</code> to set the proxy host and proxy port.\nNow, any network request will go to <code class=\"language-text\">localhost</code> running at port <code class=\"language-text\">6090</code>. This is\nwhere my mock server is running. When the mock server receives a request, it\nwill match the request with the one I have specified before and return the\nresponse associated with it. After that I do my assertion I am\nresetting the <code class=\"language-text\">http.proxyHost</code> and <code class=\"language-text\">http.proxyPort</code> so that from that point on\nnetwork requests are made directly.</p>\n<p>Alright, that’s all with mocking network requests. Next stop is the world of\nContinuous Integration.</p>\n<h3>Continuous Integration with GitHub Actions</h3>\n<p>All these testing are good for local use only. I write code, run tests and if\nall tests pass I push the code to my <code class=\"language-text\">main</code> branch. But what if I forget to run\nthe tests? Buggy code can creep into my <code class=\"language-text\">main</code> branch. Oh! I have a solution for\nthat. I have a script that will run when any code is committed. I talked about\nthat script and some other useful stuff <a href=\"https://badalsarkar.ca/blog-opensource/opensource/Blink-gets-static-analysis-tools/\">here</a>.\nThe script runs all the tests when any commit is about to happen and if any\ntests fail, the commit is aborted. Great. But there is a command <code class=\"language-text\">git commit\n--no-verify</code> which allow the commit to go through without running the script. So\nhow do I solve this? The answer is with Continuous Integration.</p>\n<p>Continuous Integration(CI) means automating the build and testing of code when\nsomeone want to add code to the project. There are many CI tools like GitHub\nActions, TravisCI, CircleCI, TeamCity etc. I have used GitHub Actions for my\nproject. I have set it up such that when any code is pushed to my <code class=\"language-text\">main</code> branch\nor when a pull request is created against the <code class=\"language-text\">main</code> branch, all my tests will\nbe run, linter will check for bugs and code formatter will ensure that codes are\nformatted correctly. If any of these fails, the code changes will be rejected.</p>\n<p>Lets see how I configured this.</p>\n<img src=\"/b9c7487c7aadff2e65607321b55d747c/githubActions.gif\" alt title=\"GitHub Actions setup\" width=\"100%\" style=\"display:block; margin-left:auto; margin-right:auto;\">\n<br>\nI have used templates already provided by GitHub Actions. I used maven template\nas my project was built with maven.\nOnce you follow the above video, you will get a `maven.yml` in `.github/workflows`\nfolder. You can customize this file as per your requirement. Read [this](https://docs.github.com/en/free-pro-team@latest/actions/guides) \nto learn how to customize this script. My script looks like below-\n<p><div id=\"gist106676565\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-maven-yml\" class=\"file my-2\">\n    \n\n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-yaml  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-maven-yml-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-maven-yml-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> This workflow will build a Java project with Maven</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-maven-yml-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#</span> For more information see: https://help.github.com/actions/language-and-framework-guides/building-and-testing-java-with-maven</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-maven-yml-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-maven-yml-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Java CI with Maven</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-maven-yml-LC5\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-maven-yml-LC6\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-ent\">on</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-maven-yml-LC7\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-ent\">push</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-maven-yml-LC8\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">branches</span>: <span class=\"pl-s\">[ master ]</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-maven-yml-LC9\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-ent\">pull_request</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-maven-yml-LC10\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">branches</span>: <span class=\"pl-s\">[ master ]</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-maven-yml-LC11\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-maven-yml-LC12\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-ent\">jobs</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-maven-yml-LC13\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-ent\">build</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-maven-yml-LC14\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-maven-yml-LC15\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">runs-on</span>: <span class=\"pl-s\">ubuntu-latest</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-maven-yml-LC16\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-maven-yml-LC17\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-ent\">steps</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-maven-yml-LC18\" class=\"blob-code blob-code-inner js-file-line\">    - <span class=\"pl-ent\">uses</span>: <span class=\"pl-s\">actions/checkout@v2</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-maven-yml-LC19\" class=\"blob-code blob-code-inner js-file-line\">    - <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Set up JDK 1.11</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-maven-yml-LC20\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-ent\">uses</span>: <span class=\"pl-s\">actions/setup-java@v1</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-maven-yml-LC21\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-ent\">with</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-maven-yml-LC22\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-ent\">java-version</span>: <span class=\"pl-c1\">1.11</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-maven-yml-LC23\" class=\"blob-code blob-code-inner js-file-line\">    - <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Cache Maven packages</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-maven-yml-LC24\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-ent\">uses</span>: <span class=\"pl-s\">actions/cache@v2</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-maven-yml-LC25\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-ent\">with</span>:</td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-maven-yml-LC26\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-ent\">path</span>: <span class=\"pl-s\">~/.m2</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-maven-yml-LC27\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-ent\">key</span>: <span class=\"pl-s\">${{ runner.os }}-m2-${{ hashFiles(&#39;**/pom.xml&#39;) }}</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-maven-yml-LC28\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-ent\">restore-keys</span>: <span class=\"pl-s\">${{ runner.os }}-m2  </span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-maven-yml-LC29\" class=\"blob-code blob-code-inner js-file-line\">    - <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Build with Maven</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-maven-yml-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-maven-yml-LC30\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-ent\">run</span>: <span class=\"pl-s\">mvn -B verify --file pom.xml</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/badalsarkar/596211e7691ebf6f6792231ef65fa606/raw/cb8abc1f5ee5d0b740a73ac92ea3748f11601308/maven.yml\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/badalsarkar/596211e7691ebf6f6792231ef65fa606#file-maven-yml\">maven.yml</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<ul>\n<li>From line 6-10, I am specifying when to execute this script.</li>\n<li>Line 12 configures all jobs. A workflow consists of one or more jobs. I have\none job here. This job runs on <code class=\"language-text\">ubuntu-latest</code> operating system.</li>\n<li>Starting line 17, I am specifying the steps that this job will run.</li>\n<li>Line 18 means GitHub Actions will download a copy of my repository</li>\n<li>Line 19 to 22, sets up Java with JDK 11.</li>\n<li>Line 24-28, caches the project dependencies. If this is not setup every time\nthe workflow runs it will download all the dependencies. This will slow down the\nworkflow. Read more about it <a href=\"https://docs.github.com/en/free-pro-team@latest/actions/guides/building-and-testing-java-with-maven#caching-dependencies\">here</a>.</li>\n<li>Line 29-30, I am running a maven command <code class=\"language-text\">mvn verify</code>. This maven command will\nrun all tests, linter and code formatting checker.</li>\n</ul>\n<p>That’s all there is to do with configuring GitHub Actions CI. Now, when I push\nany code to my <code class=\"language-text\">main</code> branch, I get the following report from GitHub Actions-</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4bacd3b1a22a953e95a99c849f212fea/c4842/gitHubActions.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABCklEQVQoz4WRSU7DQBBF+y4ElMkDJrYhCYJbZZ0s4BqcgAXiJCzYICSQYyOkTESxFOLhU79JszBYlPRVra7uV7+61eIjRfI+wzrdogTw/BIhHFyie+yj4/poWh5a9slvyb7T68M7PYctmeJ5dX33hvFtgono6n6B0c2DFAJYXqBhh20HB03rTzVatq4zG6lVusNys8N8vcXmE3h8epXOZ/DCIVzJdGIuV1VtQLjK8xxUlmVgRNFUxqXDELboqOPWAqvSwKIokIsygWrgNIbr9xHIOwaDC3TlXYybOpCpsbnCPghmxEmiHRqXbaf3L7ChR+ZaHJZlCeoHGAtQQHRJIH/UfEz9uN9AnvsCBLcicYm5U5AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"GitHub Actions\"\n        title=\"GitHub Actions\"\n        src=\"/static/4bacd3b1a22a953e95a99c849f212fea/f058b/gitHubActions.png\"\n        srcset=\"/static/4bacd3b1a22a953e95a99c849f212fea/c26ae/gitHubActions.png 158w,\n/static/4bacd3b1a22a953e95a99c849f212fea/6bdcf/gitHubActions.png 315w,\n/static/4bacd3b1a22a953e95a99c849f212fea/f058b/gitHubActions.png 630w,\n/static/4bacd3b1a22a953e95a99c849f212fea/40601/gitHubActions.png 945w,\n/static/4bacd3b1a22a953e95a99c849f212fea/78612/gitHubActions.png 1260w,\n/static/4bacd3b1a22a953e95a99c849f212fea/c4842/gitHubActions.png 1634w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Contributing to a partner’s repo</h3>\n<p>Lab 8 required us to contribute to a partners repo by adding tests. I\ncontributed to <a href=\"https://github.com/eunbeek\">Eunbee Kim’s</a> project\n<a href=\"https://github.com/eunbeek/findBrokenGlass\">findBrokenGlass</a>. This project is\nalso written in Java and built with Maven. I added a test for the following\nmethod-</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-java line-numbers\"><code class=\"language-java\">  <span class=\"token comment\">// Method under test</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">JSONObject</span> <span class=\"token function\">convertJavaObjectToJson</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> url<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">JSONObject</span> obj <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    obj<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    obj<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"status\"</span><span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> obj<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">void</span> <span class=\"token function\">testConvertJavaObjectToJson</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">JSONObject</span> actualObject <span class=\"token operator\">=</span> <span class=\"token class-name\">ConvertJavaToJson</span><span class=\"token punctuation\">.</span><span class=\"token function\">convertJavaObjectToJson</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://google.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">JSONObject</span> expectedObject <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    expectedObject<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"url\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"https://google.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    expectedObject<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"status\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">assertEquals</span><span class=\"token punctuation\">(</span>expectedObject<span class=\"token punctuation\">,</span> actualObject<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Once the test is passing, I pushed it to his repo. His repository also had CI\nworkflow set up. So when my code passed the CI tests, I created a <a href=\"https://github.com/eunbeek/findBrokenGlass/pull/20\">pull request\nin his repo</a>.</p>\n<h3>My learning</h3>\n<p>This lab was very important as I have implemented unit testing and CI to my\nproject. Unit testing is super important as this guards against code that can\nbreak my project. I have used Mocha and Chai for JavaScript before but not\nJUnit. Going forward it will be easier for me to integrate automated testing and\nCI to my future projects.</p>","frontmatter":{"title":"Implementing Testing and CI Workflow in Blink","date":"November 28, 2020","description":null}},"previous":{"fields":{"slug":"/2020/release-04-planning/2020-11-25-release-04-planning/"},"frontmatter":{"title":"Release 0.4: Planning"}},"next":{"fields":{"slug":"/2020/kafka-butterfly/2020-12-04-kafka-in-butterfly/"},"frontmatter":{"title":"Implementing Kafka in PayPal/Butterfly"}}},"pageContext":{"id":"aad0c412-9d99-5f5c-a22e-33f2f1b86dda","previousPostId":"fbba5e8b-e5ff-557b-b477-54fe87a5677e","nextPostId":"98165466-078a-52ba-837c-0b8f560a3879"}},"staticQueryHashes":["2841359383","916993862"]}